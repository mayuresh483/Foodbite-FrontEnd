{"ast":null,"code":"var _class;\nimport { Cart } from '../shared/models/Cart';\nimport { BehaviorSubject } from 'rxjs';\nimport { CartItems } from '../shared/models/CartItems';\nimport * as i0 from \"@angular/core\";\nexport class CartService {\n  constructor() {\n    this.cart = this.getCartFromLocalStorage();\n    this.cartSubject = new BehaviorSubject(this.cart);\n  }\n  addToCart(food) {\n    let cartItem = this.cart.items.find(item => item.food.id === food.id);\n    if (cartItem) {\n      return;\n    }\n    this.cart.items.push(new CartItems(food));\n    this.setCartToLocalStorage();\n  }\n  removeFromCart(foodid) {\n    this.cart.items = this.cart.items.filter(items => items.food.id != foodid);\n    this.setCartToLocalStorage();\n  }\n  changeQuantity(foodId, quantity) {\n    let cartItem = this.cart.items.find(index => index.food.id === foodId);\n    if (!cartItem) {\n      return;\n    }\n    cartItem.quantity = quantity;\n    cartItem.price = quantity * cartItem.food.price;\n    this.setCartToLocalStorage();\n  }\n  clearCart() {\n    this.cart = new Cart();\n    this.setCartToLocalStorage();\n  }\n  getCartObservable() {\n    return this.cartSubject.asObservable();\n  }\n  getCart() {\n    return this.cartSubject.value;\n  }\n  setCartToLocalStorage() {\n    this.cart.totalPrice = this.cart.items.reduce((prevSum, currentSum) => prevSum + currentSum.price, 0);\n    this.cart.totalCount = this.cart.items.reduce((prevCount, currenCount) => prevCount + currenCount.quantity, 0);\n    const cartJSON = JSON.stringify(this.cart);\n    localStorage.setItem('Cart', cartJSON);\n    this.cartSubject.next(this.cart);\n  }\n  getCartFromLocalStorage() {\n    const cartJSON = localStorage.getItem('Cart');\n    return cartJSON ? JSON.parse(cartJSON) : new Cart();\n  }\n}\n_class = CartService;\n_class.ɵfac = function CartService_Factory(t) {\n  return new (t || _class)();\n};\n_class.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: _class,\n  factory: _class.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"names":["Cart","BehaviorSubject","CartItems","CartService","constructor","cart","getCartFromLocalStorage","cartSubject","addToCart","food","cartItem","items","find","item","id","push","setCartToLocalStorage","removeFromCart","foodid","filter","changeQuantity","foodId","quantity","index","price","clearCart","getCartObservable","asObservable","getCart","value","totalPrice","reduce","prevSum","currentSum","totalCount","prevCount","currenCount","cartJSON","JSON","stringify","localStorage","setItem","next","getItem","parse","factory","ɵfac","providedIn"],"sources":["/Users/mayuresh483/Desktop/Personal Projects/Food Bite/Foodbite/src/app/services/cart.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { Cart } from '../shared/models/Cart';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { Food } from '../shared/models/Food';\nimport { CartItems } from '../shared/models/CartItems';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CartService {\n\n  private cart:Cart = this.getCartFromLocalStorage();\n  private cartSubject: BehaviorSubject<Cart> = new BehaviorSubject<Cart>(this.cart);\n\n  constructor() { }\n\n  addToCart(food:Food):void{\n    let cartItem = this.cart.items.find(item=> item.food.id === food.id);\n    if(cartItem){\n      return;\n    }\n    this.cart.items.push(new CartItems(food));\n    this.setCartToLocalStorage();\n  }\n\n  removeFromCart(foodid:string):void{\n    this.cart.items = this.cart.items.filter(items=>items.food.id != foodid);\n    this.setCartToLocalStorage();\n  }\n\n  changeQuantity(foodId:string, quantity:number){\n    let cartItem = this.cart.items.find(index => index.food.id===foodId);\n    if(!cartItem){\n      return;\n    }\n    cartItem.quantity = quantity;\n    cartItem.price = quantity * cartItem.food.price;\n    this.setCartToLocalStorage();\n  }\n\n  clearCart(){\n    this.cart = new Cart();\n    this.setCartToLocalStorage();\n  }\n\n  getCartObservable():Observable<Cart>{\n    return this.cartSubject.asObservable();\n  }\n\n  getCart():Cart{\n    return this.cartSubject.value;\n  }\n\n  private setCartToLocalStorage():void{\n    this.cart.totalPrice = this.cart.items.\n    reduce((prevSum, currentSum)=> prevSum + currentSum.price,0);\n    this.cart.totalCount = this.cart.items.\n    reduce((prevCount, currenCount)=> prevCount+ currenCount.quantity,0);\n    const cartJSON = JSON.stringify(this.cart);\n    localStorage.setItem('Cart',cartJSON);\n    this.cartSubject.next(this.cart);\n  }\n\n  private getCartFromLocalStorage():Cart{\n    const cartJSON = localStorage.getItem('Cart');\n    return cartJSON ? JSON.parse(cartJSON): new Cart();\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}